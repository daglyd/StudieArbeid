#Exercise A.15: Find difference equations for computing cos x
from math import cos

def cos_Taylor(x,n):
    ajj = 1
    sjj = 0
    j = 1

    while j <= n+1:
        aj = -x**2/ (2.0*j*(2*j-1))*ajj
        sj = sjj + ajj
        sjj = sj
        ajj = aj
        j += 1
    return sjj,abs(aj)

def cos_Taylor_test():
    x=2;n=2
    computed,aj = cos_Taylor(x,n)
    known_solution = -1.0/3.0
    tol = 10E-14
    success = abs(computed - known_solution) < tol
    msg = "Computed value does not match known solution!"
    assert success,msg
cos_Taylor_test()

for x in range(1,12,3):
    print "\n"
    print "X = %g" %(x)
    print "n - cos(x) - Approx - Difference"
    print "--------------------------------"
    for n in range(1,100,10):
        print "%-2g: %-5g %-7g %-5g" %(n, cos(x),cos_Taylor(x,n)[0],cos(x)-cos_Taylor(x,n)[0])

"""
In [41]: run cos_Taylor_series_diffeq.py


X = 1
n - cos(x) - Approx - Difference
--------------------------------
1 : 0.540302 0.5     0.0403023
11: 0.540302 0.540302 1.11022e-16
21: 0.540302 0.540302 1.11022e-16
31: 0.540302 0.540302 1.11022e-16
41: 0.540302 0.540302 1.11022e-16
51: 0.540302 0.540302 1.11022e-16
61: 0.540302 0.540302 1.11022e-16
71: 0.540302 0.540302 1.11022e-16
81: 0.540302 0.540302 1.11022e-16
91: 0.540302 0.540302 1.11022e-16


X = 4
n - cos(x) - Approx - Difference
--------------------------------
1 : -0.653644 -7      6.34636
11: -0.653644 -0.653644 4.42729e-10
21: -0.653644 -0.653644 0
31: -0.653644 -0.653644 0
41: -0.653644 -0.653644 0
51: -0.653644 -0.653644 0
61: -0.653644 -0.653644 0
71: -0.653644 -0.653644 0
81: -0.653644 -0.653644 0
91: -0.653644 -0.653644 0


X = 7
n - cos(x) - Approx - Difference
--------------------------------
1 : 0.753902 -23.5   24.2539
11: 0.753902 0.753615 0.000286929
21: 0.753902 0.753902 2.22045e-16
31: 0.753902 0.753902 2.22045e-16
41: 0.753902 0.753902 2.22045e-16
51: 0.753902 0.753902 2.22045e-16
61: 0.753902 0.753902 2.22045e-16
71: 0.753902 0.753902 2.22045e-16
81: 0.753902 0.753902 2.22045e-16
91: 0.753902 0.753902 2.22045e-16


X = 10
n - cos(x) - Approx - Difference
--------------------------------
1 : -0.839072 -49     48.1609
11: -0.839072 -2.23223 1.39316
21: -0.839072 -0.839072 3.60308e-11
31: -0.839072 -0.839072 1.52323e-13
41: -0.839072 -0.839072 1.52323e-13
51: -0.839072 -0.839072 1.52323e-13
61: -0.839072 -0.839072 1.52323e-13
71: -0.839072 -0.839072 1.52323e-13
81: -0.839072 -0.839072 1.52323e-13
91: -0.839072 -0.839072 1.52323e-13
"""
